<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"></head><link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/prettify.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/clear.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/ttypography.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/problem-statement.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/second-level-menu.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/roundbox.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/datatable.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/table-form.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/topic.css" type="text/css" charset="utf-8" />
<body><div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">F. Clear The Matrix</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>You are given a matrix <span class="tex-span"><i>f</i></span> with <span class="tex-span">4</span> rows and <span class="tex-span"><i>n</i></span> columns. Each element of the matrix is either an asterisk (<span class="tex-font-style-tt">*</span>) or a dot (<span class="tex-font-style-tt">.</span>).</p><p>You may perform the following operation arbitrary number of times: choose a square submatrix of <span class="tex-span"><i>f</i></span> with size <span class="tex-span"><i>k</i> × <i>k</i></span> (where <span class="tex-span">1 ≤ <i>k</i> ≤ 4</span>) and replace each element of the chosen submatrix with a dot. Choosing a submatrix of size <span class="tex-span"><i>k</i> × <i>k</i></span> costs <span class="tex-span"><i>a</i><sub class="lower-index"><i>k</i></sub></span> coins.</p><p>What is the minimum number of coins you have to pay to replace all asterisks with dots?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains one integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">4 ≤ <i>n</i> ≤ 1000</span>) — the number of columns in <span class="tex-span"><i>f</i></span>.</p><p>The second line contains <span class="tex-span">4</span> integers <span class="tex-span"><i>a</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>a</i><sub class="lower-index">2</sub></span>, <span class="tex-span"><i>a</i><sub class="lower-index">3</sub></span>, <span class="tex-span"><i>a</i><sub class="lower-index">4</sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 1000</span>) — the cost to replace the square submatrix of size <span class="tex-span">1 × 1</span>, <span class="tex-span">2 × 2</span>, <span class="tex-span">3 × 3</span> or <span class="tex-span">4 × 4</span>, respectively.</p><p>Then four lines follow, each containing <span class="tex-span"><i>n</i></span> characters and denoting a row of matrix <span class="tex-span"><i>f</i></span>. Each character is either a dot or an asterisk.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print one integer — the minimum number of coins to replace all asterisks with dots.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4<br />1 10 8 20<br />***.<br />***.<br />***.<br />...*<br /></pre></div><div class="output"><div class="title">Output</div><pre>9<br /></pre></div><div class="input"><div class="title">Input</div><pre>7<br />2 1 8 2<br />.***...<br />.***..*<br />.***...<br />....*..<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br /></pre></div><div class="input"><div class="title">Input</div><pre>4<br />10 10 1 10<br />***.<br />*..*<br />*..*<br />.***<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first example you can spend <span class="tex-span">8</span> coins to replace the submatrix <span class="tex-span">3 × 3</span> in the top-left corner, and <span class="tex-span">1</span> coin to replace the <span class="tex-span">1 × 1</span> submatrix in the bottom-right corner.</p><p>In the second example the best option is to replace the <span class="tex-span">4 × 4</span> submatrix containing columns <span class="tex-span">2 – 5</span>, and the <span class="tex-span">2 × 2</span> submatrix consisting of rows <span class="tex-span">2 – 3</span> and columns <span class="tex-span">6 – 7</span>.</p><p>In the third example you can select submatrix <span class="tex-span">3 × 3</span> in the top-left corner and then submatrix <span class="tex-span">3 × 3</span> consisting of rows <span class="tex-span">2 – 4</span> and columns <span class="tex-span">2 – 4</span>.</p></div></div><p>  </p></div></body></html>
