<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"></head><link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/prettify.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/clear.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/ttypography.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/problem-statement.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/second-level-menu.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/roundbox.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/datatable.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/table-form.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="file:///home/redeff/proj/cf_scr/dep/css/topic.css" type="text/css" charset="utf-8" />
<body><div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Points, Lines and Ready-made Titles</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>You are given <span class="tex-span"><i>n</i></span> distinct points on a plane with integral coordinates. For each point you can either draw a vertical line through it, draw a horizontal line through it, or do nothing.</p><p>You consider several coinciding straight lines as a single one. How many distinct pictures you can get? Print the answer modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>) — the number of points.</p><p><span class="tex-span"><i>n</i></span> lines follow. The (<span class="tex-span"><i>i</i> + 1</span>)-th of these lines contains two integers <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span"> - 10<sup class="upper-index">9</sup> ≤ <i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>) — coordinates of the <span class="tex-span"><i>i</i></span>-th point.</p><p>It is guaranteed that all points are distinct.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the number of possible distinct pictures modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4<br />1 1<br />1 2<br />2 1<br />2 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>16<br /></pre></div><div class="input"><div class="title">Input</div><pre>2<br />-1 -1<br />0 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>9<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first example there are two vertical and two horizontal lines passing through the points. You can get pictures with any subset of these lines. For example, you can get the picture containing all four lines in two ways (each segment represents a line containing it).</p><center> The first way:   <img  class="tex-graphics" height="151px"  src="0.png" style="max-width: 100.0%;max-height: 100.0%;" width="189px" />   The second way:   <img  class="tex-graphics" height="151px"  src="1.png" style="max-width: 100.0%;max-height: 100.0%;" width="189px" />   </center><p>In the second example you can work with two points independently. The number of pictures is <span class="tex-span">3<sup class="upper-index">2</sup> = 9</span>.</p></div></div><p>  </p></div></body></html>
